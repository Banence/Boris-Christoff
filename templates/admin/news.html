{% extends "admin/base.html" %}

{% block title %}Admin - News Management{% endblock %}

{% block admin_content %}
<h1 class="dashboard-title">News Management</h1>

<div class="admin-actions">
    <a href="{{ url_for('add_news') }}" class="btn-primary">
        <i class="fas fa-plus"></i> Add News Article
    </a>
</div>

<div class="admin-list">
    {% for article in news %}
    <div class="admin-list-item" id="news-{{ article.id }}">
        <div class="news-preview">
            {% if article.image %}
            <img src="{{ article.image }}" alt="{{ article.title }}" class="news-image-preview">
            {% endif %}
        </div>
        <div class="news-details">
            <div class="news-header">
                <h3>{{ article.title }}</h3>
                {% if article.featured %}
                <span class="featured-badge">Featured</span>
                {% endif %}
            </div>
            <p class="news-date">{{ article.date.strftime('%B %d, %Y') }}</p>
            <p class="news-description">{{ article.description[:200] }}...</p>
            <div class="news-actions">
                <a href="{{ url_for('edit_news', news_id=article.id) }}" class="btn-secondary">
                    <i class="fas fa-edit"></i> Edit
                </a>
                <button onclick="deleteNews('{{ article.id }}')" class="btn-danger">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<script>
function deleteNews(newsId) {
    if (confirm('Are you sure you want to delete this news article?')) {
        fetch(`/admin/news/delete/${newsId}`, {
            method: 'DELETE',
            headers: {
                'X-CSRFToken': '{{ csrf_token() }}'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById(`news-${newsId}`).remove();
                alert('News article deleted successfully!');
            } else {
                alert('Error: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while deleting the news article');
        });
    }
}
</script>
{% endblock %} 